(this.webpackJsonpsilverstreaming=this.webpackJsonpsilverstreaming||[]).push([[0],{49:function(e,t,a){e.exports=a(86)},54:function(e,t,a){},55:function(e,t,a){},81:function(e,t){},86:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(28),o=a.n(r),i=(a(54),a(1)),l=(a(55),a(7)),s=a(2);function u(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],r=t[1],o=Object(n.useRef)();return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"landingInputBox"},c.a.createElement("div",{className:"tokenGenerator"},c.a.createElement("button",{onClick:function(){for(var e="",t="ABCDEFGHJKLMNPQRSTUVXYZabcdefghijklmnopqrstuvwxyz23456789",a=t.length,n=0,c=0;c<12;c++)n=Math.floor(Math.random()*a),e+=t.charAt(n);r(e),o.current.value=e}},"Generate token")),c.a.createElement("div",{className:"input"},c.a.createElement("label",{htmlFor:"#tokenIdInput"},"Token"),c.a.createElement("input",{id:"tokenIdInput",ref:o,onChange:function(e){return r(e.target.value)},placeholder:"Input token id"})),c.a.createElement("div",{className:"buttons"},c.a.createElement(l.b,{to:"/info/watch/".concat(a),className:"modeButton"},c.a.createElement("button",null,"Watch")),c.a.createElement(l.b,{to:"/info/broadcast/".concat(a),className:"modeButton"},c.a.createElement("button",null,"Broadcast")))))}var m=a(8),d=a.n(m);function b(e){var t=Object(n.useContext)(v);return c.a.createElement("div",{id:"record-box"},t.map((function(e,t){return c.a.createElement("p",{key:t},c.a.createElement("span",{className:"name"},e.username,":"),c.a.createElement("span",{className:"text"},e.action))})))}var v=Object(n.createContext)();function f(e){var t=Object(n.useContext)(C),a=Object(n.useState)([]),r=Object(i.a)(a,2),o=r[0],l=r[1],s=Object(n.useState)([]),u=Object(i.a)(s,2),m=u[0],f=u[1],E=Object(n.useState)(""),p=Object(i.a)(E,2),O=(p[0],p[1],Object(n.useState)([])),j=Object(i.a)(O,2),h=j[0],g=j[1],w=Object(n.useState)([]),N=Object(i.a)(w,2),y=(N[0],N[1],Object(n.useState)({})),k=Object(i.a)(y,2),S=(k[0],k[1]),x=Object(n.useState)(0),I=Object(i.a)(x,2),P=I[0],B=I[1],M=Object(n.useState)([]),D=Object(i.a)(M,2),R=D[0],J=D[1],A=window.location.hostname+":4000",V=d()(A),T=Object(n.useRef)(),U=Object(n.useRef)();function G(){return(new Date).getTime()+""+Math.floor(899*Math.random()+100)}function W(e,t){var a,n={type:"system",username:e.user.username,uid:e.user.uid,action:t,msgId:G()};a=h.concat(n),B(e.onlineCount),S(e.onlineUsers),g(a);var c=JSON.parse(JSON.stringify(e.onlineUsers)),r=[];for(var o in c)r.push(c[o]);J(r)}return Object(n.useEffect)((function(){f(t.participant),l(t.uid)}),[h]),Object(n.useEffect)((function(){!function(){var e=V;e.on("login",(function(e){W(e,"login")})),e.on("exitChatbox",(function(e){W(e,"exitChatbox")})),e.on("message",(function(e){!function(e){var t,a={type:"chat",username:e.username,uid:e.uid,action:e.message,msgId:G()};t=h.concat(a),g(t)}(e)}))}()})),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"display-flex"},c.a.createElement(v.Provider,{value:h},c.a.createElement(b,null)),c.a.createElement("div",{className:"online-count",align:"right",ref:U},c.a.createElement("p",null,"Online Users: ",P)),c.a.createElement("div",{className:"online-users"},R.map((function(e,t){return c.a.createElement("li",{key:t},e)})))),c.a.createElement("div",{id:"send-box"},c.a.createElement("textarea",{rows:"1",cols:"80",ref:T,className:"text"}),c.a.createElement("div",{className:"button"},c.a.createElement("button",{type:"submit",onClick:function(){V.emit("message",{uid:o,username:m,message:T.current.value}),T.current.value=""}},"Send"))))}var E=a(48);var p=a(16),O=a(17),j=a(20),h=a(18),g=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handleClick=function(){},e}return Object(O.a)(a,[{key:"render",value:function(){return c.a.createElement("button",{onClick:this.handleClick},c.a.createElement(l.b,{to:"/home"},"Leave session"))}}]),a}(c.a.Component);function w(e){var t,a=Object(n.useRef)([]);function r(e){var t,n=Object(E.a)(a.current);try{for(n.s();!(t=n.n()).done;){t.value.muted=e}}catch(c){n.e(c)}finally{n.f()}}return Object(n.useEffect)((function(){console.log(e.participants.length),a.current=a.current.slice(0,e.participants.length),console.log(a.current)}),[e.participants]),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"muteButtons"},c.a.createElement("button",{onClick:function(){return r(!0)}},"Mute all"),c.a.createElement("button",{onClick:function(){return r(!1)}},"Unmute all")),c.a.createElement("div",{className:"leaveButton"},c.a.createElement(g,null)),c.a.createElement("div",{className:"thumbnails"},null===(t=e.participants)||void 0===t?void 0:t.map((function(t,n){return c.a.createElement("div",{className:"streamThumbnail",key:n-1,onClick:function(){return function(t){e.selectParticipant(t)}(t)}},c.a.createElement("video",{className:"participantVideoPlayer",autoPlay:!0,controls:!0,playsInline:!0,source:t.src,ref:function(e){return a.current[n-1]=e},key:n}))}))))}var N=Object(n.createContext)();function y(e){Object(n.useRef)(),Object(n.useRef)(),Object(n.useRef)(),d()(window.location.origin);var t=[{id:"1",src:"1s"},{id:"2",src:"2s"},{id:"3",src:"3s"},{id:"4",src:"4s"},{id:"5",src:"5s"},{id:"6",src:"6s"},{id:"7",src:"7s"},{id:"8",src:"8s"},{id:"9",src:"9s"}],a=Object(n.useState)(t),r=Object(i.a)(a,2),o=r[0],l=(r[1],Object(n.useState)(t[0])),s=Object(i.a)(l,2),u=s[0],m=s[1];var b=Object(n.useState)([]),v=Object(i.a)(b,2),E=v[0],p=v[1];return Object(n.useEffect)((function(){var e=window.prompt("Please enter your username ");e||(e=Date.now()),p(e)}),[]),c.a.createElement("div",{className:"container"},c.a.createElement("span",null,null===u||void 0===u?void 0:u.id),c.a.createElement("video",{className:"mainVideoPlayer",autoPlay:!0,controls:!0,playsInline:!0,src:null===u||void 0===u?void 0:u.src}),c.a.createElement(w,{participants:o,selectParticipant:function(e){m(e)}}),c.a.createElement(N.Provider,{value:E},c.a.createElement(f,null)))}var k=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handleClick=function(){var e=document.getElementById("viewerVideo");null!=e&&(e.muted?e.muted=!1:e.muted=!0)},e}return Object(O.a)(a,[{key:"render",value:function(){return c.a.createElement("button",{onClick:this.handleClick},"Mute microphone")}}]),a}(c.a.Component);function S(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),r=a[0];a[1];return c.a.createElement("div",{className:"container"},c.a.createElement("video",{id:"viewerVideo",className:"mainVideoPlayer",autoPlay:!0,controls:!0,playsInline:!0,src:r}),c.a.createElement("div",{className:"leaveButton"},c.a.createElement(k,null),c.a.createElement(g,null)),c.a.createElement(f,null))}var C=Object(n.createContext)();function x(e){var t=window.location.hostname+":4000",a=Object(n.useState)(""),r=Object(i.a)(a,2),o=r[0],l=r[1],u=d()(t),m=Object(n.useState)(""),b=Object(i.a)(m,2),v=b[0],f=b[1],E=Object(n.useState)(!1),p=Object(i.a)(E,2),O=p[0],j=p[1],h=Object(s.g)().wb,g={participant:v,uid:o};return Object(n.useEffect)((function(){!function(){if(null===window.sessionStorage.getItem("userData")){var e=window.prompt("Please enter your username "),t=(new Date).getTime()+""+Math.floor(9*Math.random()+1);e||(e="guest"+t),f(e),l(t);var a={uid:t,username:e},n=JSON.stringify(a);window.sessionStorage.setItem("userData",n),""!=e&&u.emit("login",{uid:t,username:e})}else{var c=window.sessionStorage.getItem("userData");a=JSON.parse(c);l(a.uid),f(a.username),""!=v&&u.emit("login",{uid:o,username:v})}}(),window.onbeforeunload=function(){j(!0),u.emit("exitChatbox")}}),[O]),"watch"==h?c.a.createElement("div",{className:"container"},c.a.createElement(C.Provider,{value:g},c.a.createElement(S,null))):"broadcast"==h?c.a.createElement("div",{className:"container"},c.a.createElement(C.Provider,{value:g},c.a.createElement(y,null))):void 0}var I=function(){var e=Object(n.useState)(!0),t=Object(i.a)(e,2);return t[0],t[1],c.a.createElement("div",{className:"App"},c.a.createElement(l.a,{basename:"/"},c.a.createElement(l.b,{to:"/",className:"AppHeader"},"Silverstreaming Demo"),c.a.createElement(s.d,null,c.a.createElement(s.b,{path:"/home",component:u}),c.a.createElement(s.b,{path:"/info/:wb/:id",component:x}),c.a.createElement(s.b,{exact:!0,path:"/",render:function(){return c.a.createElement(s.a,{to:"/home"})}}),c.a.createElement(s.b,{path:"*",render:function(){return c.a.createElement(s.a,{to:"/home"})}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.aaf2763b.chunk.js.map